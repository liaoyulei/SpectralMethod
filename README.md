# Spectral Method
## Boundary value problem(BVP)
Consider the second-order boundary value problem

$$\begin{cases}
	-u''(x)+u(x)=f(x), &x\in(-1,1),\\
	u(-1)=c_-,&u(1)=c_+.
\end{cases}$$

We test the smooth solution $u(x)=\sin(k\pi x)$ when $k>0$ and the limited regularity solution

$$u = \begin{cases}
\cosh(x+1) - \dfrac{x^2}2 - x,& -1\le x\le 0,\\
\cosh(x+1) - \cosh(x) - x + 1,& 0\le x\le 1
\end{cases}$$

when $k=0$. We find that the condition numbers of matrices in different methods satisfy `A1main.m`$\gg$`A2main.m`$\gg$`A3main.m`.

### The collocation method
`A1main.m` uses the collocation method. Let $\\{x_i,w_i\\}\_{i=0}^N$ are the Legendre-Gauss-Lobatto points generated by `LGL.m`. And  $\\{h_j\\}\_{j=0}^N $ is the Lagrange nodal basis satisfy  $h_j(x_i)=\delta_{ij} $. The algebra system $(-D^2+I)c=b$ is derived by

$$
\sum_{j=0}^N(-h_j''(x_i)+h_j(x_i))u(x_j)=f(x_i)  
$$

with $u(x_0)=c_-$ and $u(x_N)=c_+$, and $D$ is the first-order derivative matrix generated by `LGLdiff.m`.

* `LGL.m` generates the Legendre-Gauss-Lobatto points by the Newton iterative method in [1,\S 3.3.2].

* `LGLdiff.m` generates the first order derivative matrix by [1, Eq. (3.203)].
	
### The spectral-Galerkin scheme with the nodal basis
`A2main.m` uses the spectral-Galerkin scheme with the nodal basis. The algebra system $(D^T\mathrm{diag}(w)D+\mathrm{diag}(w))c=\mathrm{diag}(w)f$ is derived by

$$
\sum_{j=0}^N\bigl((h_j',h_i')\_N+(h_j,h_i)\_N\bigr)u(x_j)=(f,h_i)\_N,
$$

and $(f,h_i)\_N=f_iw_i$.

### The spectral-Galerkin scheme with the Legendre polynomials
`A3main.m` uses the spectral-Galerkin scheme with the combination of Legendre polynomials. To satisfy the boundary condition that $\phi_n(-1)=\phi_n(1)=0$, the basis

$$
\phi_n(x)=\dfrac1{\sqrt{4n+6}}(P_{n+2}(x)-P_n(x)),\qquad n=0,\cdots,N-2,
$$

here  $P_n $ is the  $n $-order Legendre polynomial. Then  $(\phi_n',\phi_m')=\delta_{nm} $. Consider the homogeneous boundary conditon  $c_-=c_+=0 $, the algebra system  $(I+M)c=(f,\phi) $ is derived by

$$
\sum_{j=0}^N\bigl((\phi_j',\phi_i')+(\phi_j,\phi_i)\bigr)\tilde{u}\_j=(f,\phi_i),
$$

here $M$ is a symmetric five-diagonal matrix and can by derived by the orthogonality. The most important tool in this procedure is the Legendre transform and the inverse Legendre transform.


* Legendre transform [1, Eq. (3.156)]: We know the value  $\\{f(x_i)\\}\_{i=0}^N $, then we can use the Legendre transform to get  $\\{\hat{f}\_j\\}\_{j=0}^N $ such that

$$
I_Nf(x)=\sum_{j=0}^N\hat{f}\_jP_j(x).
$$

Then we can calculate $(f,\phi_i)\simeq(I_Nf,\phi_i)\_N$.

* Inverse Legendre transform [1, Eq. (3.157)]: We can get  $\\{\hat{u}\_j\\}\_{j=0}^N $ by  $\\{\tilde{u}\_j\\}\_{j=0}^{N-2} $, then we can use the inverse Legendre transform to get $\\{u(x_i)\\}\_{i=0}^N$.

* Non-homogeneous boundary condition: Choose  $\alpha $ and  $\beta $ such that  $u-\alpha P_0-\beta P_1 $ satisfies the homogeneous boundary condition and can be discretized as before.

## Time-dependent Burgers' equation(Burgers)
Consider the viscous Burgers' equation

$$\begin{cases}
\partial_tu+u\partial_xu=\epsilon\partial_x^2u, & x\in(-1,1),\\
u(\pm 1,t)=0, &t\ge 0,\\
u(x,0)=-\sin(\pi x), &x\in(-1,1).
\end{cases}$$

In each time step, the PDE can be transformed into an ODE with variable $x$

$$
u^{n+1}(x)-\epsilon t\partial_x^2u^{n+1}(x)=u^n(x)-tu^n(x)\partial_xu^n(x).
$$

Hence the algebra system is  $(\epsilon tI+M)c=(u^n-tu^n\partial_xu^n,\phi) $. The term  $-(u^n\partial_xu^n,\phi) $ is calculated by

$$
-(u^n\partial_xu^n,\phi)=-\dfrac12(\partial_x(u^n)^2,\phi)=\dfrac12((u^n)^2,\phi').
$$

## References
[1] J. Shen, T. Tao, and L.-L, Wang, *Spectral Methods: Algorithms, Analysis and Applications*, Springer Series in Computational Mathematics, **vol. 41**, Springer-Verlag Berlin Heidelberg, 2011.
